---
import {
  BriefcaseBusiness,
  ChevronsDown,
  Download,
  MessageCircle,
} from "lucide-react";
import Button from "./buttons/Button.astro";
import { Icon } from "astro-icon/components";
---

<section
  id="welcome-section"
  class="section w-full h-[calc(100vh-50px)] flex flex-col justify-center items-center relative"
>
  <div class="relative flex items-center justify-center w-96">
    <img
      id="profile-image"
      src="/assets/profile.webp"
      alt="profile photo"
      class="relative mb-5 border-2 border-green-400 rounded-full w-36 h-36 opacity-0"
    />

    <!-- Aviso de disponibilidad con diseño mejorado -->
    <div
      id="availability-badge"
      class="absolute z-50 bottom-2 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs font-medium px-4 py-2 rounded-full shadow-lg backdrop-blur-sm border border-green-300/20 opacity-0"
    >
      <span class="flex items-center gap-1.5">
        <span class="w-2 h-2 bg-white rounded-full animate-pulse"></span>
        Disponible para trabajar
      </span>
    </div>
  </div>
  <div class="flex flex-col items-center justify-center px-8 welcome-text">
    <h1
      id="welcome-title"
      class="mb-6 text-2xl text-center text-transparent uppercase lg:text-6xl text-balance bg-clip-text bg-linear-to-b from-black dark:from-white via-gray-400 dark:via-gray-400 to-black dark:to-white drop-shadow-md opacity-0"
      style="font-family: 'Bowlby One', sans-serif;"
    >
      Bienvenido A
      <br /> mi rinconcito digital
    </h1>
    <div class="w-4/5 lg:w-3/5 items-center justify-center mb-8">
      <p
        id="welcome-description"
        class="text-black/60 dark:text-white/70 text-md lg:text-xl text-center text-balance leading-relaxed opacity-0"
      >
        ¡Hola! 👋🏼 soy Jose Armando de los Santos Amadís, desarrollador de
        aplicaciones y soluciones web. Aquí encontrarás información sobre mí,
        mis trabajos y cómo contactarme.
      </p>
    </div>
  </div>

  <div
    id="action-buttons"
    class="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 lg:w-2/3 xl:w-1/2 opacity-0"
  >
    <Button
      variant="default"
      size="lg"
      href="/projects"
      class="w-full sm:w-auto shadow-lg hover:shadow-xl transition-shadow duration-300"
    >
      <BriefcaseBusiness className="w-5 h-5" />
      Ver Proyectos
    </Button>

    <Button
      variant="outline"
      size="lg"
      href="/CV.pdf"
      download
      target="_blank"
      class="w-full sm:w-auto shadow-md hover:shadow-lg transition-shadow duration-300"
    >
      <Download className="w-5 h-5" />
      Descargar CV
    </Button>

    <Button
      variant="ghost"
      size="lg"
      href="/contact"
      class="w-full sm:w-auto hover:bg-blue-50 dark:hover:bg-blue-950/20"
    >
      <Icon name="mdi:message-bubble" class="w-5 h-5" />
      Contacto
    </Button>
  </div>

  <ChevronsDown
    id="scroll-indicator"
    className="w-10 h-10 text-blue-500 dark:text-white/80 absolute bottom-10 opacity-0"
  />
</section>

<script>
  import { gsap } from "gsap";

  // Función simple para ejecutar las animaciones
  function animateWelcome() {
    const profileImage = document.getElementById("profile-image");
    const availabilityBadge = document.getElementById("availability-badge");
    const welcomeTitle = document.getElementById("welcome-title");
    const welcomeDescription = document.getElementById("welcome-description");
    const actionButtons = document.getElementById("action-buttons");
    const scrollIndicator = document.getElementById("scroll-indicator");

    // Configuración inicial
    gsap.set(
      [
        profileImage,
        availabilityBadge,
        welcomeTitle,
        welcomeDescription,
        actionButtons,
        scrollIndicator,
      ],
      {
        opacity: 0,
        y: 50,
      }
    );

    // Timeline de animación
    const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

    tl.to(profileImage, { duration: 1, opacity: 1, y: 0 })
      .to(availabilityBadge, { duration: 0.6, opacity: 1, y: 0 }, "-=0.5")
      .to(welcomeTitle, { duration: 0.8, opacity: 1, y: 0 }, "-=0.3")
      .to(welcomeDescription, { duration: 0.8, opacity: 1, y: 0 }, "-=0.5")
      .to(actionButtons, { duration: 0.6, opacity: 1, y: 0 }, "-=0.5")
      .to(
        scrollIndicator,
        {
          duration: 0.6,
          opacity: 1,
          y: 0,
          onComplete: () => {
            gsap.to(scrollIndicator, {
              y: 10,
              duration: 1,
              repeat: -1,
              yoyo: true,
              ease: "power1.inOut",
            });
          },
        },
        "-=0.3"
      );
  }

  // Ejecutar las animaciones cuando el DOM esté listo
  document.addEventListener("DOMContentLoaded", animateWelcome);

  // Ejecutar cuando Astro complete una transición de página
  document.addEventListener("astro:page-load", animateWelcome);
</script>
